TCP基于以字节单位的滑动窗口来实现可靠传输

发送窗口的后沿的后面部分是已发送并收到确认可以删除

发送窗口的前沿的前面部分是不允许发送的序号

后沿移动情况：

- 不动（没有收到新的确认）
- 前移（收到了新的确认）

前沿移动：

- 通常是不断向前移动
- 不动：
	- 没有收到新的确认，对方通知窗口大小也不变；
	- 收到新确认但对方通知的窗口缩小，使发送窗口前沿正好不动。
- 向后收缩（对方通知窗口缩小）

### 如何确认发送窗口的状态？

使用三个指针P1，P2，P3分别指向相应的字节序号

- 小于P1的是已发送并已收到确认的部分
- 大于等于P3的是不允许发送的部分
- P3 - P1 = 发送窗口的尺寸
- P2 - P1 = 已发送但尚未收到确认的字节数
- P3 - P2 = 允许发送但当前尚未发送的字节数（又称为可用窗口或有效窗口）

### 几点注意

- 虽然发送方的发送窗口是根据接收方的接收窗口设置的，但在同一时刻，发送方的发送窗口并不总是和接收窗口一样大。
- 网络传送窗口值需要经历一定的时间，并且这个时间还不是确定的
- 发送方可以根据网络当时的拥塞情况适当减小自己的发送窗口尺寸
- 对于不按序到达的数据应如何处理，TCP并无明确规定
- TCP通常对不按序到达的数据是先临时存放在接收窗口中，等到字节流中所缺少的字节收到后，再按序交付上层的应用进程
- TCP要求接收方必须有累计确认和稍待确认机制，这样可以减小传输开销。接收方可以在合适的时候发送确认，也可以在自己有数据要发送时把确认信息顺便带上
- 接收方不应该过分推迟确认，否则会导致发送方不必要的超时重传
- TCP的通信时全双工通信，通信中的每一方都在发送和接收报文段，因此，每一方都有自己的发送窗口和接收窗口。