## 运输层概述

- 运输层直接为应用进程间的逻辑通信提供服务
- 向高层用户屏蔽了下面网络核心的细节（如，网络拓扑、采用的路由协议）使应用进程好像在两个运输层实体之间有一条端到端的逻辑通信信道
- 面向链接的TCP和无连接的UDP

## 运输层端口号、复用与分用

TCP/IP体系协议使用端口号来区分应用层不同应用进程：

- 端口号使用16比特表示，取值范围为0~65535
- 端口号只具有本地意义，只是为了标识本计算机应用层中的各进程。不同计算机的相同端口号没有联系

### 熟知端口号

范围：0~1023。

IANA把这些端口号指派给了TCP/IP体系中最重要的一些应用协议。例如：FTP使用21/20，HTTP使用80，DNS使用53。

UDP协议：协议字段 = 17

- RIP ：520
- DNS：53
- TFTP：69
- SNMP：161
- DHCP：67或68

TCP协议：协议字段 = 6

- SMTP：25
- FTP：21 or 20
- BGP：179
- HTTP：80
- HTTPS：443

上面协议在网络层都封装为IP协议

### 登记端口号

范围：1024~49151。

被没有熟知端口号的应用程序使用，必须在IANA登记，以避免重复

### 短暂端口号

范围：49152~65535。

留给客户进程选择暂时使用。当服务器进程收到客户进程时，就知道客户进程所使用的动态端口号。通信结束后可供其他客户进程以后使用。

### 复用和分用

![image-20200607174945223](运输层概述.assets/image-20200607174945223.png)

## UDP和TCP对比

### 用户数据报协议UDP(User Datagram Protocol)

- 支持单播、多播和广播，$\color{red}{无连接}$，支持一对一，一对多，多对多
- 面向应用报文
- 向上层提供无连接不可靠传输服务（适用于实时应用，电话、会议）
- 用户数据首部只有8个字节
- 不使用流量控制和拥塞控制

### 传输控制协议TCP(Transmission Control Protocol)

- 仅支持单播，$\color{red}{面向连接}$，只能是一对一通信
- 面向字节流
- 向上层提供面向连接的可靠传输服务（适用于要求可靠传输的应用，比如文件传输）
- 首部最小长度20字节，最大60字节
- 支持全双工传输
- 使用流量控制和拥塞控制



![image-20200612151130464](运输层概述.assets/image-20200612151130464.png)